<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Today</title>
  <style>
    :root {
      --bg: #f9fafb;
      --card: #ffffff;
      --accent: #111827;
      --muted: #6b7280;
      --danger: #ef4444;
      --success: #16a34a;
    }

    * { box-sizing: border-box; }
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      background: var(--bg);
      color: var(--accent);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
    }

    .wrap {
      width: min(640px, 100%);
    }
    .card {
      background: var(--card);
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    }

    h1 {
      margin: 0 0 8px;
      font-size: 24px;
      font-weight: 600;
      text-align: center;
    }
    p.lead {
      margin: 0 0 20px;
      color: var(--muted);
      font-size: 14px;
      text-align: center;
    }

    form.row {
      display: flex;
      gap: 8px;
    }
    input[type="text"] {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      font-size: 14px;
    }
    input[type="text"]:focus {
      border-color: var(--accent);
      outline: none;
    }
    button.btn {
      padding: 0 16px;
      border-radius: 8px;
      border: none;
      background: var(--accent);
      color: white;
      font-weight: 500;
      cursor: pointer;
      font-size: 16px;
    }
    button.btn:hover {
      opacity: 0.9;
    }

    ul.todolist {
      list-style: none;
      padding: 0;
      margin: 20px 0 0;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    li.item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      background: #fff;
      transition: transform 0.3s ease, background 0.3s ease;
    }
    li.item .text {
      flex: 1;
      font-size: 14px;
    }
    li.item.completed .text {
      text-decoration: line-through;
      color: var(--muted);
    }

    input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: var(--success);
      cursor: pointer;
    }

    .actions {
      display: flex;
      gap: 4px;
    }
    .icon-btn {
      background: transparent;
      border: 0;
      cursor: pointer;
      padding: 4px;
      border-radius: 6px;
      font-size: 14px;
      color: var(--muted);
    }
    .icon-btn:hover {
      background: #f3f4f6;
    }
    .icon-btn.del { color: var(--danger); }
    .icon-btn.move { color: var(--accent); }

    .footer {
      margin-top: 20px;
    }
    .footer-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .small {
      font-size: 13px;
      color: var(--muted);
    }
    .clear {
      background: transparent;
      border: 0;
      color: var(--muted);
      cursor: pointer;
      font-size: 13px;
    }
    .clear:hover { color: var(--danger); }

    .progress-wrap {
      width: 100%;
      background: #e5e7eb;
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    .progress {
      height: 100%;
      background: var(--accent);
      width: 0;
      border-radius: 4px;
      transition: width 0.3s ease;
    }

    .pomodoro {
      text-align: center;
      margin-top: 20px;
    }
    .time {
      font-size: 32px;
      font-weight: 600;
      margin-bottom: 12px;
    }
    .pomodoro button {
      margin: 0 4px;
      padding: 8px 14px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      background: var(--accent);
      color: white;
      font-size: 14px;
    }
    .pomodoro button:hover {
      opacity: 0.9;
    }
    .settings {
      margin-top: 12px;
      font-size: 14px;
      color: var(--muted);
    }
    .settings input {
      width: 50px;
      padding: 4px;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      margin: 0 4px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="wrap card">
    <h1>Today</h1>
    <p class="lead">Keep your day minimal and focused</p>

    <form id="form" class="row" onsubmit="return false">
      <input id="newTask" type="text" placeholder="Add a new task..." autocomplete="off" />
      <button id="addBtn" class="btn">＋</button>
    </form>

    <ul id="list" class="todolist" aria-live="polite"></ul>

    <div class="footer">
      <div class="footer-top">
        <div class="small" id="count">0 tasks</div>
        <div>
          <button id="clearCompleted" class="clear">Clear completed</button>
          <button id="clearAll" class="clear">Clear all</button>
        </div>
      </div>
      <div class="progress-wrap">
        <div id="progress" class="progress"></div>
      </div>
    </div>

    <div class="pomodoro">
      <div id="time" class="time">25:00</div>
      <button id="start">Start</button>
      <button id="pause">Pause</button>
      <button id="reset">Reset</button>
      <div class="settings">
        Work: <input id="workLength" type="number" min="1" value="25"> min
        Break: <input id="breakLength" type="number" min="1" value="5"> min
        <button id="applySettings">Apply</button>
      </div>
    </div>
  </div>

  <script>
    const newTask = document.getElementById('newTask');
    const list = document.getElementById('list');
    const addBtn = document.getElementById('addBtn');
    const clearCompleted = document.getElementById('clearCompleted');
    const clearAll = document.getElementById('clearAll');
    const count = document.getElementById('count');
    const progress = document.getElementById('progress');

    let todos = JSON.parse(localStorage.getItem('todayTodos') || '[]');

    function save(){ localStorage.setItem('todayTodos', JSON.stringify(todos)); render(); }

    function render(){
      list.innerHTML = '';
      if(todos.length === 0){
        list.innerHTML = '<li class="small" style="padding:12px;text-align:center;color:var(--muted); background:#f3f4f6; border-radius:8px">No tasks yet</li>';
      } else {
        todos.forEach((t, i) => {
          const li = document.createElement('li');
          li.className = 'item' + (t.done ? ' completed' : '');

          const chk = document.createElement('input');
          chk.type = 'checkbox';
          chk.checked = !!t.done;
          chk.addEventListener('change', () => { todos[i].done = chk.checked; save(); });

          const txt = document.createElement('div');
          txt.className = 'text';
          txt.textContent = t.text;

          const actions = document.createElement('div');
          actions.className = 'actions';

          const up = document.createElement('button');
          up.className = 'icon-btn move';
          up.innerHTML = '⬆️';
          up.title = 'Move up';
          up.addEventListener('click', () => { if(i>0){ [todos[i-1], todos[i]] = [todos[i], todos[i-1]]; save(); smoothReorder(); } });

          const down = document.createElement('button');
          down.className = 'icon-btn move';
          down.innerHTML = '⬇️';
          down.title = 'Move down';
          down.addEventListener('click', () => { if(i<todos.length-1){ [todos[i+1], todos[i]] = [todos[i], todos[i+1]]; save(); smoothReorder(); } });

          const edit = document.createElement('button');
          edit.className = 'icon-btn';
          edit.title = 'Edit';
          edit.innerHTML = '✏️';
          edit.addEventListener('click', () => { startEdit(i); });

          const del = document.createElement('button');
          del.className = 'icon-btn del';
          del.title = 'Delete';
          del.innerHTML = '🗑️';
          del.addEventListener('click', () => { todos.splice(i,1); save(); });

          actions.appendChild(up);
          actions.appendChild(down);
          actions.appendChild(edit);
          actions.appendChild(del);

          li.appendChild(chk);
          li.appendChild(txt);
          li.appendChild(actions);

          list.appendChild(li);
        });
      }

      const remaining = todos.filter(t=>!t.done).length;
      count.textContent = remaining + (remaining === 1 ? ' task left' : ' tasks left');

      const doneCount = todos.filter(t=>t.done).length;
      const progressPercent = todos.length ? (doneCount / todos.length) * 100 : 0;
      progress.style.width = progressPercent + '%';
    }

    function smoothReorder(){
      const items = list.querySelectorAll('.item');
      items.forEach((item) => {
        item.style.transition = 'transform 0.3s ease';
        item.style.transform = 'translateY(5px)';
        setTimeout(()=>{ item.style.transform='translateY(0)'; },50);
      });
    }

    function addTask(text){
      const trimmed = text.trim();
      if(!trimmed) return;
      todos.push({text: trimmed, done: false});
      save();
    }

    function startEdit(index){
      const current = todos[index];
      const newText = prompt('Edit task:', current.text);
      if(newText === null) return;
      const trimmed = newText.trim();
      if(trimmed){ todos[index].text = trimmed; save(); }
    }

    addBtn.addEventListener('click', () => { addTask(newTask.value); newTask.value=''; });
    newTask.addEventListener('keydown', (e) => {
      if(e.key === 'Enter'){
        addTask(newTask.value);
        newTask.value = '';
      }
    });

    clearCompleted.addEventListener('click', () => { todos = todos.filter(t=>!t.done); save(); });
    clearAll.addEventListener('click', () => { if(confirm('Clear ALL tasks?')){ todos = []; save(); } });

    render();

    // Pomodoro Timer
    const timeEl = document.getElementById('time');
    const startBtn = document.getElementById('start');
    const pauseBtn = document.getElementById('pause');
    const resetBtn = document.getElementById('reset');
    const workLengthInput = document.getElementById('workLength');
    const breakLengthInput = document.getElementById('breakLength');
    const applySettingsBtn = document.getElementById('applySettings');

    let timer;
    let timeLeft = 25 * 60;
    let isRunning = false;
    let workLength = 25;
    let breakLength = 5;

    function updateTimer(){
      const minutes = Math.floor(timeLeft / 60).toString().padStart(2,'0');
      const seconds = (timeLeft % 60).toString().padStart(2,'0');
      timeEl.textContent = `${minutes}:${seconds}`;
    }

    function startTimer(){
      if(isRunning) return;
      isRunning = true;
      timer = setInterval(() => {
        if(timeLeft > 0){
          timeLeft--;
          updateTimer();
        } else {
          clearInterval(timer);
          isRunning = false;
          alert('Time is up! Take a break.');
        }
      }, 1000);
    }

    function pauseTimer(){
      clearInterval(timer);
      isRunning = false;
    }

    function resetTimer(){
      clearInterval(timer);
      isRunning = false;
      timeLeft = workLength * 60;
      updateTimer();
    }

    applySettingsBtn.addEventListener('click', () => {
      workLength = parseInt(workLengthInput.value) || 25;
      breakLength = parseInt(breakLengthInput.value) || 5;
      timeLeft = workLength * 60;
      updateTimer();
    });

    startBtn.addEventListener('click', startTimer);
    pauseBtn.addEventListener('click', pauseTimer);
    resetBtn.addEventListener('click', resetTimer);

    updateTimer();
  </script>
</body>
</html>